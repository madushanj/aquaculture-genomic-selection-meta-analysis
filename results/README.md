# Results Directory

This directory contains all outputs from the meta-analysis including figures, tables, and model objects.

## Directory Structure

```
results/
├── figures/          # All plots and visualizations
│   ├── .gitkeep
│   └── (PDF, PNG files)
├── tables/           # Summary tables and model objects
│   ├── .gitkeep
│   └── (CSV, RDS files)
└── README.md         # This file
```

## File Organization

### figures/

**Purpose**: Store all visualizations generated by analysis scripts

**Generated Files**:

#### Forest Plots
- `forest_plot_main.pdf` - Main random-effects forest plot
- `forest_plot_publication.png/pdf` - Publication-ready version with annotations
- `forest_plot_cumulative.pdf` - Cumulative meta-analysis by year
- `forest_plot_species.pdf` - Subgroup analysis by species
- `forest_plot_trait.pdf` - Subgroup analysis by trait category
- `forest_plot_method.pdf` - Subgroup analysis by GS method

#### Publication Bias Plots
- `funnel_plot_standard.pdf` - Standard funnel plot
- `funnel_plot_contour.pdf` - Contour-enhanced funnel plot
- `funnel_plot_trimfill.pdf` - Trim-and-fill adjusted funnel plot
- `funnel_plot_ggplot.png/pdf` - Enhanced ggplot2 version
- `radial_plot.pdf` - Galbraith radial plot
- `effect_se_scatter.pdf` - Effect size vs standard error

#### Diagnostic Plots
- `influence_diagnostics.pdf` - Influence and outlier diagnostics
- Leave-one-out sensitivity plots (if generated)

#### Meta-Regression Plots
- `metaregression_sample_size.png/pdf` - Accuracy vs sample size
- `metaregression_snps.png/pdf` - Accuracy vs SNP density
- Additional moderator plots as generated

#### PRISMA Diagram
- `PRISMA_flow_diagram.png` - Study flow diagram
- `PRISMA_flow_diagram.pdf` - Vector version for publication

**File Formats**:
- **PDF**: Vector graphics, best for publication, scalable
- **PNG**: Raster graphics, 300 DPI, for presentations and web
- **High resolution**: 300 DPI minimum for publication

### tables/

**Purpose**: Store summary tables and model objects

**Generated Files**:

#### Model Objects (RDS format)
- `meta_analysis_models.rds` - All meta-analysis model objects
  - Fixed-effect model
  - Random-effects model
  - Leave-one-out results
  - Influence diagnostics
- `subgroup_analysis_models.rds` - All subgroup models
  - Species subgroups
  - Trait subgroups
  - Method subgroups
  - Platform subgroups

#### Summary Tables (CSV format)
- `meta_analysis_summary.csv` - Main results table
  - Fixed and random-effects estimates
  - Confidence intervals
  - Heterogeneity statistics
  - P-values

- `publication_bias_tests.csv` - Bias assessment results
  - Egger's test
  - Begg's test
  - Trim-and-fill results
  - Fail-safe N

- `subgroup_*.csv` - Subgroup results
  - `subgroup_species.csv`
  - `subgroup_trait.csv`
  - `subgroup_method.csv`
  - `subgroup_platform.csv`

- `study_characteristics.csv` - Descriptive table of included studies
- `summary_by_species.csv` - Descriptive statistics by species
- `summary_by_trait.csv` - Descriptive statistics by trait

## Generated by Scripts

Results are generated automatically by running the analysis scripts in order:

1. **01-data-preparation.R** → No outputs in results/
2. **02-meta-analysis.R** → Generates:
   - `figures/forest_plot_main.pdf`
   - `figures/influence_diagnostics.pdf`
   - `tables/meta_analysis_models.rds`
   - `tables/meta_analysis_summary.csv`

3. **03-publication-bias.R** → Generates:
   - `figures/funnel_plot_*.pdf`
   - `figures/radial_plot.pdf`
   - `figures/effect_se_scatter.pdf`
   - `tables/publication_bias_tests.csv`

4. **04-subgroup-analysis.R** → Generates:
   - `figures/forest_plot_species.pdf`
   - `figures/forest_plot_trait.pdf`
   - `figures/forest_plot_method.pdf`
   - `tables/subgroup_analysis_models.rds`
   - `tables/subgroup_*.csv`

5. **05-visualization.R** → Generates:
   - `figures/forest_plot_publication.png/pdf`
   - `figures/forest_plot_cumulative.pdf`
   - `figures/funnel_plot_ggplot.png/pdf`
   - `figures/metaregression_*.png/pdf`
   - `figures/PRISMA_flow_diagram.png/pdf`
   - `tables/study_characteristics.csv`
   - `tables/summary_by_*.csv`

## File Naming Conventions

### Figures
- Descriptive names indicating plot type
- Separate main analysis from subgroups
- Include format extension (.pdf, .png)
- No spaces in filenames (use underscores)

**Format**: `{plot_type}_{specific_analysis}.{format}`

**Examples**:
```
forest_plot_main.pdf
funnel_plot_contour.pdf
metaregression_sample_size.png
forest_plot_species.pdf
```

### Tables
- CSV for human-readable summaries
- RDS for R objects (models, complex structures)
- Descriptive names
- Include analysis type

**Format**: `{analysis}_{detail}.{format}`

**Examples**:
```
meta_analysis_summary.csv
subgroup_species.csv
meta_analysis_models.rds
```

## Using Results

### Loading Model Objects

```r
# Load all meta-analysis models
models <- readRDS("results/tables/meta_analysis_models.rds")

# Access specific models
re_model <- models$re_model
fe_model <- models$fe_model
loo_results <- models$loo_results
influence <- models$influence

# Work with models
summary(re_model)
forest(re_model)
```

### Loading Tables

```r
# Load summary table
library(readr)
summary <- read_csv("results/tables/meta_analysis_summary.csv")

# Load subgroup results
species_results <- read_csv("results/tables/subgroup_species.csv")

# View in RStudio
View(summary)
```

### Using Figures

**In Manuscript**:
- Use PDF versions for LaTeX/Word
- Cite figure file in manuscript
- Include figure legends

**In Presentations**:
- Use PNG versions
- High resolution (300 DPI)
- Consider resizing for slides

**Online Sharing**:
- PNG for compatibility
- Compress if needed for web
- Maintain attribution

## Quality Control

### Figures
- [ ] All figures generated without errors
- [ ] Axes labeled clearly
- [ ] Legends included where needed
- [ ] Text readable at intended size
- [ ] Colors print well in grayscale
- [ ] Consistent style across figures
- [ ] High resolution (300 DPI minimum)

### Tables
- [ ] All expected tables present
- [ ] Numbers match between formats
- [ ] Column headers descriptive
- [ ] Decimal places appropriate
- [ ] Missing values indicated
- [ ] Units specified where needed

## Interpretation Guide

### Forest Plots
- **Squares**: Individual study estimates (size ∝ weight)
- **Horizontal lines**: 95% confidence intervals
- **Diamond**: Pooled estimate and CI
- **Vertical line**: Reference line (usually at 0 or 1)

### Funnel Plots
- **Symmetry**: No publication bias expected
- **Asymmetry**: Potential publication bias or heterogeneity
- **Contours**: Statistical significance regions

### Heterogeneity Statistics
- **I²**: 
  - 0-25%: Low heterogeneity
  - 25-50%: Moderate
  - 50-75%: Substantial
  - 75-100%: Considerable
- **Q test**: 
  - p < 0.05: Significant heterogeneity
  - p ≥ 0.05: No significant heterogeneity
- **τ²**: Between-study variance

## Customization

### Modifying Figures

To customize a figure:
1. Locate generating script (see "Generated by Scripts" above)
2. Open script in R/RStudio
3. Find plotting code section
4. Modify parameters (colors, size, labels)
5. Re-run script section
6. Check output in results/figures/

**Example modifications**:
```r
# Change figure dimensions
pdf("results/figures/forest_plot_main.pdf", width = 14, height = 12)

# Change colors
forest(model, col = "darkblue")

# Adjust text size
forest(model, cex = 0.9)

# Add custom title
title(main = "My Custom Title")
```

### Creating Additional Tables

```r
# Load processed data
data <- readRDS("data/processed/prepared_data.rds")

# Create custom summary
library(dplyr)
custom_summary <- data %>%
  group_by(year) %>%
  summarise(
    n_studies = n(),
    mean_accuracy = mean(prediction_accuracy_r)
  )

# Save
write.csv(custom_summary, "results/tables/summary_by_year.csv", row.names = FALSE)
```

## Archiving and Sharing

### For Manuscript Submission
1. Select publication-quality figures (PDF format)
2. Prepare figure legends
3. Include all summary tables
4. Compress large files if needed
5. Organize in submission package

### For Supplementary Materials
- All forest plots (including subgroups)
- All bias assessment plots
- Influence diagnostics
- Complete summary tables
- Model objects (if journal allows)

### For Data Repository (Zenodo/OSF)
- Upload all figures and tables
- Include README describing files
- Add appropriate license
- Link to main repository
- Cite in manuscript

## Reproducibility

### Verification Steps
1. Delete all files in results/
2. Re-run all scripts in order
3. Compare new outputs to originals
4. Check for any differences
5. Investigate discrepancies

### Documentation
- Script version used
- R version and package versions
- Date generated
- Any custom modifications

### Session Info
Each script saves session information:
```r
# Check package versions used
sessionInfo()
```

## Common Issues

### Issue: "Cannot open PDF device"
**Solution**: Close any open PDF files, check write permissions

### Issue: "Figure not updating"
**Solution**: Clear graphics device with `dev.off()`, re-run code

### Issue: "Out of memory" 
**Solution**: Close other applications, reduce figure resolution, process in batches

### Issue: "Missing file"
**Solution**: Ensure previous scripts completed successfully, check working directory

## Version Control

### Git Tracking
- `.gitkeep` files: Tracked
- Generated figures/tables: **NOT tracked** (see .gitignore)
- README: Tracked

### Why Results Not in Git?
- Large file sizes (especially PNGs)
- Frequently regenerated
- Can be reproduced from data and scripts
- Repository stays lightweight

### Sharing Results
- Use releases/tags in GitHub
- Upload to data repository (Zenodo)
- Include in supplementary materials
- Link in manuscript

## Backup

Before final submission:
- [ ] Copy all results to backup location
- [ ] Archive with date stamp
- [ ] Include with manuscript files
- [ ] Upload to data repository

## Contact

Questions about results or visualizations:
- [Contact information]

---

**Last Updated**: 2025-12-09  
**Status**: Ready for analysis outputs  
**Expected Files**: ~30 figures, ~10 tables
